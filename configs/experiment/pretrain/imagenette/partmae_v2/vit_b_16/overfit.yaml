# @package _global_

# to execute this experiment run:
# python train.py experiment=example

defaults:
  - /debug/overfit
  - pretrain/imagenette/partmae_v2/vit_b_16/_base
  - override /trainer: gpu

tags: ["pretrain", "imagenette", "partmae_v2", "vit_b_16", "overfit"]

callbacks:
  reconstruction_logger:
    _target_: src.callbacks.loggers.pretrain.reconstruction_v3.ReconstructionLogger
    every_n_epochs: 100
    num_samples: 4

trainer:
  min_epochs: 500
  max_epochs: 1000
  limit_val_batches: 0
  limit_test_batches: 0
  check_val_every_n_epoch: 100
  deterministic: true

model:
  net:
    mask_ratio: 0.25
    pos_mask_ratio: 0.75
    sampler: stratified_jittered
  optimizer:
    lr: 1e-3
    # lr: 0.0024
  scheduler:
    warmup_t: 400
    t_initial: 1000

data:
  batch_size: 8
  num_workers: 0

# @package _global_
defaults:
  - pretrain/in1k/partmae_v6/vit_b_16/_base
  - override /data: in1k_snellius

compile: False

trainer:
  max_epochs: 200
  accelerator: gpu
  strategy: ddp
  num_nodes: 1
  devices: 4
  acumulate_grad_batches: 2

scheduler:
  # 625 steps per epoch when effective batch size is 2048
  warmup_t: 6250 # 10 epochs * 625 steps/epoch
  t_initial: 125000 # 200 epochs * 625 steps/epoch

train_dataloader:
  batch_size: 256
  num_workers: 16
